#!/bin/bash -x

get_x() {
	echo ${1:0:4}
}

get_y() {
	echo ${1:5}
}

get_bar_height() {
	if [ -z "$1" ]; then
		echo  ""
	elif [ "$1" -lt 1080 ]; then
		echo "2.5%"
	elif [ "$1" -ge 1080 ]; then
		echo "2.75%"
	fi
}

# Primary
PM_NAME=$(xrandr | awk '$2 == "connected" && $3 == "primary" {print $1}')
PM_RES=$(xrandr | awk '$2 == "connected" && awk $3 == "primary" {getline; print $1}')
PM_HEIGHT=$(get_y $PM_RES)
PM_BAR_HEIGHT=$(get_bar_height $PM_HEIGHT)

export PM_NAME
export PM_RES
export PM_HEIGHT
export PM_BAR_HEIGHT

# Left
LM_NAME=$(xrandr | awk '$2 == "connected" && $4 == "left" {print $1}')
LM_RES=$(xrandr | awk '$2 == "connected" && $4 == "left" {getline; print $1}')
LM_HEIGHT=$(get_y $LM_RES)

[ -z "$LM_NAME" ] || export LM_NAME
[ -z "$LM_RES" ] || export LM_RES
[ -z "$LM_HEIGHT" ] || (export LM_HEIGHT; export LM_BAR_HEIGHT=$(get_bar_height $LM_HEIGHT))

# Right
RM_NAME=$(xrandr | awk '$2 == "connected" && $4 == "right" {print $1}')
RM_RES=$(xrandr | awk '$2 == "connected" && $4 == "right" {getline; print $1}')
RM_HEIGHT=$(get_y $RM_RES)

[ -z "$RM_NAME" ] || export RM_NAME
[ -z "$RM_RES" ] || export RM_RES
[ -z "$RM_HEIGHT" ] || (export RM_HEIGHT; export RM_BAR_HEIGHT=$(get_bar_height $RM_HEIGHT))
